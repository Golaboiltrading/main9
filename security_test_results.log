Testing OWASP Top 10 Security Features for Oil & Gas Finder API at: https://97cdbb83-8ee9-4f68-b3c2-729c6dd484c8.preview.emergentagent.com

ğŸ” Testing Register basic user...
âŒ Failed - Expected 200, got 500
Failed to create basic user

ğŸ” Testing Register premium user...
âŒ Failed - Expected 200, got 500
Failed to create premium user

ğŸ” Testing Register enterprise user...
âŒ Failed - Expected 200, got 500
Failed to create enterprise user

ğŸ” Testing Register admin user...
âŒ Failed - Expected 200, got 500
Failed to create admin user

ğŸ” Testing Login with correct password (admin user)...
âŒ Failed - Expected 200, got 401
Error details: {'detail': 'Invalid email or password'}

ğŸ” Testing Login with incorrect password (admin user)...
âœ… Passed - Status: 401

ğŸ” Testing Input Validation: Invalid email format...
âŒ Failed - Expected 400, got 422
Error details: {'detail': [{'type': 'value_error', 'loc': ['body', 'email'], 'msg': 'value is not a valid email address: An email address must have an @-sign.', 'input': 'not-an-email', 'ctx': {'reason': 'An email address must have an @-sign.'}}]}

ğŸ” Testing Input Validation: Weak password...
âŒ Failed - Expected 400, got 422
Error details: {'detail': [{'type': 'string_too_short', 'loc': ['body', 'password'], 'msg': 'String should have at least 8 characters', 'input': 'weak', 'ctx': {'min_length': 8}, 'url': 'https://errors.pydantic.dev/2.11/v/string_too_short'}]}

ğŸ” Testing Input Validation: SQL injection attempt in login...
âŒ Failed - Expected 401, got 422
Error details: {'detail': [{'type': 'value_error', 'loc': ['body', 'email'], 'msg': 'value is not a valid email address: An email address must have an @-sign.', 'input': "' OR 1=1 --", 'ctx': {'reason': 'An email address must have an @-sign.'}}]}

ğŸ” Testing Rate Limiting on /api/status (10 per minute)...
Request 1: Status 200
Request 2: Status 200
Request 3: Status 200
Request 4: Status 200
Request 5: Status 200
Request 6: Status 200
Request 7: Status 200
Request 8: Status 200
Request 9: Status 200
Request 10: Status 200
Request 11: Status 200
Request 12: Status 200
âŒ Failed - Rate limiting not applied on /api/status

ğŸ” Testing Rate Limiting on /api/auth/register (5 per minute)...
Request 1: Status 500
Request 2: Status 500
Request 3: Status 500
Request 4: Status 500
Request 5: Status 500
Request 6: Status 500
Request 7: Status 500
âŒ Failed - Rate limiting not applied on /api/auth/register
âœ… Passed - Security headers check

Security Headers:
  Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' https:; connect-src 'self' https:; frame-ancestors 'none';
  Referrer-Policy: strict-origin-when-cross-origin
  Strict-Transport-Security: max-age=15724800; includeSubDomains
  X-Content-Type-Options: nosniff
  X-Frame-Options: DENY
âœ… Passed - CORS allowed for origin: http://localhost:3000
âœ… Passed - CORS allowed for origin: https://localhost:3000
âœ… Passed - CORS allowed for origin: https://oilgasfinder.com
âœ… Passed - CORS allowed for origin: https://www.oilgasfinder.com
âœ… Passed - CORS correctly blocked for origin: https://malicious-site.com

ğŸ” Testing Security Logging: Failed login attempt...
âœ… Passed - Status: 401

================================================================================
ğŸ” OWASP TOP 10 SECURITY TESTING SUMMARY FOR OIL & GAS FINDER API
================================================================================
âœ… Tests passed: 8/18 (44.4%)

2. Cryptographic Failures: 1/2 tests passed
  âŒ Login with correct password (admin user): Expected status 200, got 401

3. Injection Vulnerabilities: 0/3 tests passed
  âŒ Input Validation: Invalid email format: Expected status 400, got 422
  âŒ Input Validation: Weak password: Expected status 400, got 422
  âŒ Input Validation: SQL injection attempt in login: Expected status 401, got 422

4. Rate Limiting: 0/2 tests passed
  âŒ Rate Limiting: /api/status: Unknown error
  âŒ Rate Limiting: /api/auth/register: Unknown error

5. Security Headers and CORS: 6/6 tests passed

6. Security Audit Logging: 1/1 tests passed

================================================================================
